{"version":3,"sources":["components/TopicItem/TopicItem.module.scss","pages/Topic/Topic.module.scss","components/RouterNavigator/matchPath.js","components/RouterNavigator/RouterNavigator.js","components/RouterNavigator/index.js","utils/createPage.js","schemas.js","models/TopicFeeds.js","utils/htmlToText.js","components/TopicItem/index.js","components/TopicItem/TopicItem.js","pages/Home/Home.js","pages/Home/index.js","models/TopicDetail.js","pages/Topic/Topic.js","App.js","serviceWorker.js","index.js","../../cnodejs.api/lib/index.js"],"names":["module","exports","content","topic","cache","cacheLimit","cacheCount","matchPath","pathname","options","arguments","length","undefined","path","_options","_options$exact","exact","_options$strict","strict","_options$sensitive","sensitive","concat","reduce","matched","_compilePath","cacheKey","end","pathCache","keys","result","regexp","pathToRegexp","compilePath","match","exec","_match","Object","toArray","url","values","slice","isExact","params","memo","key","index","name","history","createHashHistory","getRouteIndex","location","query","parse","search","Number","_","getNextRouteIndex","getInitialRouteStack","rootRoute","RouterNavigator","props","_this","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","popPage","goBack","pushPage","nextURL","nextIndex","indexOf","navigator","current","push","handleHistoryChange","action","lastIndex","lastLocation","popIndex","route","pages","renderPage","_ref","routes","onlyPath","replace","Component","some","routeMathch","component","react_default","a","createElement","assertThisInitialized","createRef","initialRouteStack","root","window","unlisten","listen","_this$props","initialRoute","objectWithoutProperties","react_onsenui","assign","ref","PureComponent","defaultProps","createPage","models","getInitialProps","mapStateToProps","mapDispatchToProps","Page","ConnectedPage","connect","WrappedPage","_PureComponent","state","mounted","inherits","createClass","value","store","context","rcc","model","Date","now","setState","_this2","unmodel","map","displayName","contextTypes","PropTypes","object","author","Schema","entity","TopicFeeds","namespace","api","page","then","data","item","author_id","topicItem","objectSpread","id","meta","hasMore","entities","schema","getTopics","getData","getEntity","getState","ListPage","caches","TopicItem","className","classNames","card--material","ons","platform","isAndroid","card--material__title","title","classes","card--material__content","html","container","document","innerHTML","innerText","htmlToText","Home","onPullHookChange","pullHookState","onRefresh","done","refreshDone","onLoadMore","Promise","resolve","loadMoreDone","isRowLoaded","_ref2","topics","renderTopic","_ref3","parent","style","dist_es","columnIndex","rowIndex","components_TopicItem","onClick","pageContentEle","CellMeasurerCache","fixedWidth","fixedHeight","pageEle","findDOMNode","querySelector","prevProps","prevState","refreshing","moreLoading","_this$state","renderToolbar","icon","onChange","onLoad","size","spin","scrollElement","_ref4","height","width","isScrolling","registerChild","scrollTop","rowCount","loadMoreRows","autoHeight","deferredMeasurementCache","onRowsRendered","rowHeight","rowRenderer","topicFeeds","_ref5","dispatch","actions","initiateIfNeed","_ref6","initiate","getInitiate","loadMore","getLoadMore","moreLoadError","error","loading","refreshError","_ref7","TopicDetail","schemas","getTopic","entitiesState","articleEntity","getDetail","DetailPage","Topic","dangerouslySetInnerHTML","__html","replies","dataSource","renderRow","reply","renderReplies","ROUTES","topicDetail","App","components_RouterNavigator","isLocalhost","Boolean","hostname","registerValidSW","swUrl","config","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","onUpdate","onSuccess","catch","init","ReactDOM","render","es","src_App","getElementById","URL","process","href","origin","addEventListener","fetch","response","contentType","headers","get","status","ready","unregister","reload","checkValidServiceWorker","defineProperty","setAccessToken","accessToken","localStorage","setItem","PREFIX","getAccessToken","getItem","request","method","originalReturn","accesstoken","test","Error","json","success","error_msg","loadTopicList","tab","loadTopicDetail","collectTopic","isCollect","Content-Type","body","likeReply","loadUserDetail","loadUserCollections","loadMessages","markMessage","markAllMessage","login","obj","target","i","prototype","hasOwnProperty","_objectWithoutProperties","logout"],"mappings":"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","file":"static/js/main.f1c49f11.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"content\":\"TopicItem_content__1paU7\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"topic\":\"Topic_topic__2D3q7\"};","import pathToRegexp from 'path-to-regexp';\n\nconst cache = {};\nconst cacheLimit = 10000;\nlet cacheCount = 0;\n\nfunction compilePath(path, options) {\n  const cacheKey = `${options.end}${options.strict}${options.sensitive}`;\n  const pathCache = cache[cacheKey] || (cache[cacheKey] = {});\n\n  if (pathCache[path]) return pathCache[path];\n\n  const keys = [];\n  const regexp = pathToRegexp(path, keys, options);\n  const result = { regexp, keys };\n\n  if (cacheCount < cacheLimit) {\n    pathCache[path] = result;\n    cacheCount += 1;\n  }\n\n  return result;\n}\n\n/**\n * Public API for matching a URL pathname to a path.\n */\nfunction matchPath(pathname, options = {}) {\n  if (typeof options === 'string') options = { path: options };\n\n  const { exact = true, strict = false, sensitive = false } = options;\n\n  const paths = [].concat(options.path);\n\n  return paths.reduce((matched, path) => {\n    if (matched) return matched;\n    const { regexp, keys } = compilePath(path, {\n      end: exact,\n      strict,\n      sensitive,\n    });\n    const match = regexp.exec(pathname);\n\n    if (!match) return null;\n\n    const [url, ...values] = match;\n    const isExact = pathname === url;\n\n    if (exact && !isExact) return null;\n\n    return {\n      path, // the path used to match\n      url: path === '/' && url === '' ? '/' : url, // the matched portion of the URL\n      isExact, // whether or not we matched exactly\n      params: keys.reduce((memo, key, index) => {\n        memo[key.name] = values[index];\n        return memo;\n      }, {}),\n    };\n  }, null);\n}\n\nexport default matchPath;\n","import url from 'url';\nimport PropTypes from 'prop-types';\nimport React, { createRef, PureComponent } from 'react';\nimport { Navigator } from 'react-onsenui';\nimport { createHashHistory } from 'history';\nimport matchPath from './matchPath';\n\nconst history = createHashHistory();\nconst getRouteIndex = location => {\n  const { query } = url.parse(location.search, true);\n  return Number((query && query._) || '0');\n};\nconst getCurrRouteIndex = () => getRouteIndex(history.location);\nconst getNextRouteIndex = () => getCurrRouteIndex() + 1;\nconst getInitialRouteStack = rootRoute => {\n  if (history.location.pathname !== rootRoute) {\n    return [\n      { path: '/' }, // 后退时可能和浏览器地址不匹配\n      { path: `${history.location.pathname}${history.location.search}` },\n    ];\n  }\n  return [{ path: '/' }];\n};\n\nclass RouterNavigator extends PureComponent {\n  static propTypes = {\n    root: PropTypes.string, // 根路由地址\n    routes: PropTypes.arrayOf(\n      PropTypes.shape({\n        component: PropTypes.func.isRequired,\n        path: PropTypes.string.isRequired,\n        exact: PropTypes.bool,\n        strict: PropTypes.bool,\n      })\n    ).isRequired,\n  };\n\n  static defaultProps = {\n    root: '/',\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.navigator = createRef();\n    this.lastLocation = history.location;\n    this.initialRouteStack = getInitialRouteStack(props.root);\n  }\n\n  componentDidMount() {\n    window.a = this.navigator.current;\n    this.unlisten = history.listen(this.handleHistoryChange);\n  }\n\n  componentWillUnmount() {\n    if (typeof this.unlisten === 'function') {\n      this.unlisten();\n    }\n  }\n\n  popPage = options => {\n    history.goBack();\n  };\n\n  pushPage = (path, options) => {\n    const nextIndex = getNextRouteIndex();\n    let nextURL;\n    if (path.indexOf('?') >= 0) {\n      nextURL = `${path}&_=${nextIndex}`;\n    } else {\n      nextURL = `${path}?_=${nextIndex}`;\n    }\n    this.navigator.current.pushPage({ path: nextURL }, options);\n    history.push(nextURL);\n  };\n\n  handleHistoryChange = (location, action) => {\n    if (action === 'POP') {\n      const lastIndex = getRouteIndex(this.lastLocation);\n      const popIndex = getRouteIndex(location);\n      const route = { path: `${location.pathname}${location.search}` };\n      if (popIndex > lastIndex) {\n        this.navigator.current.pushPage(route);\n      } else if (\n        popIndex < lastIndex &&\n        this.navigator.current.pages.length > 1\n      ) {\n        this.navigator.current.popPage();\n      }\n    }\n    this.lastLocation = location;\n  };\n\n  renderPage = ({ path }, navigator) => {\n    const { routes } = this.props;\n    const onlyPath = path.replace(/\\?.*$/gi, '');\n    let match = null;\n    let Component = null;\n    routes.some(route => {\n      const routeMathch = matchPath(onlyPath, route);\n      if (routeMathch) {\n        match = routeMathch;\n        Component = route.component;\n        return true;\n      }\n      return false;\n    });\n    if (Component) {\n      return (\n        <Component\n          key={path}\n          history={history}\n          location={history.location}\n          match={match}\n          navigator={this}\n        />\n      );\n    }\n    return null; // TODO 404\n  };\n\n  render() {\n    const { routes, initialRoute, ...props } = this.props;\n    return (\n      <Navigator\n        {...props}\n        ref={this.navigator}\n        initialRouteStack={this.initialRouteStack}\n        renderPage={this.renderPage}\n      />\n    );\n  }\n}\n\nexport default RouterNavigator;\n","import RouterNavigator from './RouterNavigator';\n\nexport default RouterNavigator;\n","import PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport React, { PureComponent } from 'react';\n\nexport default ({\n  models,\n  getInitialProps,\n  mapStateToProps,\n  mapDispatchToProps,\n}) => Page => {\n  const ConnectedPage = connect(\n    mapStateToProps,\n    mapDispatchToProps\n  )(Page);\n  class WrappedPage extends PureComponent {\n    static displayName = `createPage(${Page.displayName ||\n      Page.name ||\n      'Page'})`;\n\n    static contextTypes = {\n      store: PropTypes.object,\n    };\n\n    constructor(props) {\n      super(props);\n\n      this.state = {\n        mounted: false,\n      };\n      this.models = null;\n    }\n\n    componentDidMount() {\n      const { store } = this.context;\n      if (store) {\n        this.models = Object.keys(models).reduce((rcc, key) => {\n          const model = new models[key](Date.now());\n          store.model(model);\n          rcc[key] = model;\n          return rcc;\n        }, {});\n        getInitialProps({ props: this.props, store, models: this.models });\n      }\n      this.setState({ mounted: true });\n    }\n\n    componentWillUnmount() {\n      const { store } = this.context;\n      if (store && this.models) {\n        store.unmodel(Object.keys(this.models).map(key => this.models[key]));\n      }\n    }\n\n    render() {\n      const { mounted } = this.state;\n      if (!mounted) {\n        return null;\n      }\n      return <ConnectedPage {...this.props} models={this.models} />;\n    }\n  }\n  return WrappedPage;\n};\n","import { Schema } from 'redumd';\n\nexport const author = new Schema('authors');\nexport const topic = new Schema('topics', {\n  author: author.entity,\n});\n","import { entities, ListPage } from 'redumd';\nimport * as api from 'cnodejs.api';\nimport { topic } from '../schemas';\n\nclass TopicFeeds extends ListPage {\n  constructor(namespace = '') {\n    super(`TopicFeeds/${namespace}`, {\n      api: page => {\n        return api.loadTopicList('', page, 15).then(data => {\n          return {\n            data: data.map(item => {\n              const { author, author_id, ...topicItem } = item;\n              topicItem.author = {\n                ...author,\n                id: author_id,\n              };\n              return topicItem;\n            }),\n            meta: {\n              page,\n              hasMore: data.length > 0,\n            },\n          };\n        });\n      },\n      entities,\n      schema: topic,\n    });\n\n    this.getTopics = state =>\n      this.getData(state).map(id =>\n        topic.getEntity(entities.getState(state), id)\n      );\n  }\n}\n\nexport default TopicFeeds;\n","const caches = {};\n\nexport default html => {\n  if (caches[html]) return caches[html];\n  const container = document.createElement('div');\n  container.innerHTML = html;\n  caches[html] = container.innerText;\n  return caches[html];\n};\n","import TopicItem from './TopicItem';\n\nexport default TopicItem;\n","import ons from 'onsenui';\nimport classNames from 'classnames';\nimport React from 'react';\nimport classes from './TopicItem.module.scss';\nimport htmlToText from '../../utils/htmlToText';\n\nconst TopicItem = ({ topic, ...props }) => (\n  <div\n    {...props}\n    className={classNames('card', {\n      'card--material': ons.platform.isAndroid(),\n    })}\n  >\n    <div\n      className={classNames('card__title', {\n        'card--material__title': ons.platform.isAndroid(),\n      })}\n    >\n      {topic.title}\n    </div>\n    <div\n      className={classNames('card__content', classes.content, {\n        'card--material__content': ons.platform.isAndroid(),\n      })}\n    >\n      {htmlToText(topic.content)}\n    </div>\n  </div>\n);\n\nexport default TopicItem;\n","import React, { createRef, PureComponent } from 'react';\nimport { findDOMNode } from 'react-dom';\nimport { Icon, Page, PullHook, Toolbar, ToolbarButton } from 'react-onsenui';\nimport {\n  CellMeasurer,\n  CellMeasurerCache,\n  InfiniteLoader,\n  List,\n  WindowScroller,\n} from 'react-virtualized';\nimport createPage from '../../utils/createPage';\nimport TopicFeeds from '../../models/TopicFeeds';\nimport TopicItem from '../../components/TopicItem';\n\nclass Home extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      mounted: false,\n      pullHookState: 'initial',\n    };\n    this.page = createRef();\n    this.pageContentEle = null;\n    this.cache = new CellMeasurerCache({\n      fixedWidth: true,\n      fixedHeight: false,\n    });\n  }\n\n  componentDidMount() {\n    const pageEle = findDOMNode(this.page.current);\n    if (pageEle) {\n      const pageContentEle = pageEle.querySelector('.page__content');\n      this.pageContentEle = pageContentEle;\n    }\n    this.setState({ mounted: true });\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.refreshing && !this.props.refreshing) {\n      this.setState({ pullHookState: 'initial' });\n      if (this.refreshDone) {\n        this.refreshDone();\n        this.refreshDone = null;\n      }\n    }\n    if (prevProps.moreLoading && !this.props.moreLoading) {\n      if (this.loadMoreDone) {\n        this.loadMoreDone();\n        this.loadMoreDone = null;\n      }\n    }\n  }\n\n  onPullHookChange = ({ state }) => {\n    this.setState({ pullHookState: state });\n  };\n\n  onRefresh = done => {\n    this.refreshDone = done;\n    this.props.onRefresh();\n  };\n\n  onLoadMore = () => {\n    this.props.onLoadMore();\n    return new Promise(resolve => {\n      this.loadMoreDone = resolve;\n    });\n  };\n\n  isRowLoaded = ({ index }) => {\n    const count = this.props.topics ? this.props.topics.length : 0;\n    return index < count;\n  };\n\n  renderTopic = ({ key, index, parent, style }) => {\n    const topic = this.props.topics[index];\n    if (!topic) {\n      return index > 0 ? <div key={key}>加载中...</div> : null;\n    }\n    return (\n      <CellMeasurer\n        key={key}\n        cache={this.cache}\n        columnIndex={0}\n        parent={parent}\n        rowIndex={index}\n      >\n        <div style={style}>\n          <TopicItem\n            onClick={() => this.props.navigator.pushPage(`/topic/${topic.id}`)}\n            topic={topic}\n          />\n        </div>\n      </CellMeasurer>\n    );\n  };\n\n  render() {\n    const { topics } = this.props;\n    const { mounted, pullHookState } = this.state;\n    return (\n      <Page\n        ref={this.page}\n        renderToolbar={() => (\n          <Toolbar>\n            <div className=\"left\">\n              <ToolbarButton>\n                <Icon icon=\"md-menu\" />\n              </ToolbarButton>\n            </div>\n            <div className=\"center\">CNode 社区</div>\n          </Toolbar>\n        )}\n      >\n        <PullHook onChange={this.onPullHookChange} onLoad={this.onRefresh}>\n          {pullHookState === 'initial' ? (\n            <span>\n              <Icon size={35} spin={false} icon=\"ion-arrow-down-a\" />\n              <span>下拉刷新</span>\n            </span>\n          ) : pullHookState === 'preaction' ? (\n            <span>\n              <Icon size={35} spin={false} icon=\"ion-arrow-up-a\" />\n              <span>松开刷新</span>\n            </span>\n          ) : (\n            <span>\n              <Icon size={35} spin icon=\"ion-load-d\" />\n              <span>加载中...</span>\n            </span>\n          )}\n        </PullHook>\n        {mounted ? (\n          <WindowScroller scrollElement={this.pageContentEle}>\n            {({ height, width, isScrolling, registerChild, scrollTop }) => {\n              if (!height || !width) {\n                return null;\n              }\n              const rowCount = topics ? topics.length + 1 : 0;\n              return (\n                <div ref={registerChild}>\n                  <InfiniteLoader\n                    isRowLoaded={this.isRowLoaded}\n                    loadMoreRows={this.onLoadMore}\n                    rowCount={rowCount}\n                  >\n                    {props => (\n                      <List\n                        ref={props.registerChild}\n                        autoHeight\n                        deferredMeasurementCache={this.cache}\n                        height={height}\n                        width={width}\n                        isScrolling={isScrolling}\n                        onRowsRendered={props.onRowsRendered}\n                        rowCount={rowCount}\n                        rowHeight={this.cache.rowHeight}\n                        rowRenderer={this.renderTopic}\n                        scrollTop={scrollTop}\n                      />\n                    )}\n                  </InfiniteLoader>\n                </div>\n              );\n            }}\n          </WindowScroller>\n        ) : null}\n      </Page>\n    );\n  }\n}\n\nexport default createPage({\n  models: {\n    topicFeeds: TopicFeeds,\n  },\n  getInitialProps: ({ store, models: { topicFeeds } }) => {\n    store.dispatch(topicFeeds.actions.initiateIfNeed());\n  },\n  mapStateToProps: (state, { models: { topicFeeds } }) => {\n    const initiate = topicFeeds.getInitiate(state);\n    const loadMore = topicFeeds.getLoadMore(state);\n    return {\n      topics: topicFeeds.getTopics(state),\n      hasMore: topicFeeds.hasMore(state),\n      moreLoadError: loadMore.error,\n      moreLoading: loadMore.loading,\n      refreshError: initiate.error,\n      refreshing: initiate.loading,\n    };\n  },\n  mapDispatchToProps: (dispatch, { models: { topicFeeds } }) => ({\n    onRefresh: () => dispatch(topicFeeds.actions.initiate()),\n    onLoadMore: () => dispatch(topicFeeds.actions.loadMore()),\n  }),\n})(Home);\n","import Home from './Home';\n\nexport default Home;\n","import { entities, DetailPage } from 'redumd';\nimport * as api from 'cnodejs.api';\nimport * as schemas from '../schemas';\n\nclass TopicDetail extends DetailPage {\n  constructor(namespace = '') {\n    super(`TopicDetail/${namespace}`, {\n      api: id =>\n        api.loadTopicDetail(id).then(({ author, author_id, ...data }) => ({\n          data: {\n            ...data,\n            author: {\n              ...author,\n              id: author_id,\n            },\n          },\n        })),\n      entities,\n      schema: schemas.topic,\n    });\n\n    this.getTopic = state => {\n      const entitiesState = entities.getState(state);\n      const articleEntity = this.getDetail(state);\n      return {\n        ...articleEntity,\n        author: articleEntity\n          ? schemas.author.getEntity(entitiesState, articleEntity.author)\n          : null,\n      };\n    };\n  }\n}\n\nexport default TopicDetail;\n","import React, { PureComponent } from 'react';\nimport {\n  BackButton,\n  Card,\n  List,\n  ListItem,\n  ListTitle,\n  Page,\n  Toolbar,\n} from 'react-onsenui';\nimport createPage from '../../utils/createPage';\nimport * as models from '../../models';\nimport classes from './Topic.module.scss';\n\nclass Topic extends PureComponent {\n  renderTopic(topic) {\n    if (!topic) {\n      return null;\n    }\n    return (\n      <Card className={classes.topic}>\n        <div className=\"title\">{topic.title}</div>\n        <div\n          className=\"content\"\n          dangerouslySetInnerHTML={{ __html: topic.content }}\n        />\n      </Card>\n    );\n  }\n\n  renderReplies(replies = []) {\n    return (\n      <div>\n        <ListTitle>{`${replies.length}条回复`}</ListTitle>\n        <List\n          dataSource={replies}\n          renderRow={(reply, index) => {\n            return (\n              <ListItem key={reply.id}>\n                <div dangerouslySetInnerHTML={{ __html: reply.content }} />\n              </ListItem>\n            );\n          }}\n        />\n      </div>\n    );\n  }\n\n  render() {\n    const { topic, navigator } = this.props;\n    return (\n      <Page\n        renderToolbar={() => (\n          <Toolbar>\n            <div className=\"left\">\n              <BackButton onClick={() => navigator.popPage()}>返回</BackButton>\n            </div>\n            <div className=\"center\">话题</div>\n          </Toolbar>\n        )}\n      >\n        {topic ? this.renderTopic(topic) : null}\n        {topic && topic.replies ? this.renderReplies(topic.replies) : null}\n      </Page>\n    );\n  }\n}\n\nexport default createPage({\n  models: {\n    topicDetail: models.TopicDetail,\n  },\n  getInitialProps: ({ props: { match }, store, models: { topicDetail } }) => {\n    store.dispatch(topicDetail.actions.initiateIfNeed(match.params.id));\n  },\n  mapStateToProps: (state, { models: { topicDetail } }) => {\n    const initiate = topicDetail.getInitiate(state);\n    return {\n      topic: topicDetail.getTopic(state),\n      refreshError: initiate.error,\n      refreshing: initiate.loading,\n    };\n  },\n  mapDispatchToProps: (dispatch, { models: { topicDetail } }) => ({\n    onRefresh: () => dispatch(topicDetail.actions.initiate()),\n  }),\n})(Topic);\n","import React, { PureComponent } from 'react';\nimport 'onsenui/css/onsenui.css';\nimport 'onsenui/css/onsen-css-components.css';\nimport RouterNavigator from './components/RouterNavigator';\nimport Home from './pages/Home';\nimport Topic from './pages/Topic';\n\nconst ROUTES = [\n  {\n    path: '/',\n    component: Home,\n  },\n  {\n    path: '/topic/:id',\n    component: Topic,\n  },\n];\n\nclass App extends PureComponent {\n  render() {\n    return <RouterNavigator routes={ROUTES} />;\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { init } from 'redumd';\nimport { Provider } from 'react-redux';\nimport 'react-virtualized/styles.css';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nconst store = init({});\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n);\n\nif (process.env.NODE_ENV === 'production') {\n  // If you want your app to work offline and load faster, you can change\n  // unregister() to register() below. Note this comes with some pitfalls.\n  // Learn more about service workers: http://bit.ly/CRA-PWA\n  // serviceWorker.unregister();\n  serviceWorker.register();\n}\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction _objectWithoutProperties(obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n}\n\nvar PREFIX = 'cnodejs.practice.com';\nvar ACCESS_TOKEN = PREFIX + '.ACCESS_TOKEN';\nvar BASE_URL = 'https://cnodejs.org/api/v1';\n\nvar setAccessToken = function setAccessToken(accessToken) {\n  return localStorage.setItem(ACCESS_TOKEN, accessToken);\n};\n\nvar getAccessToken = exports.getAccessToken = function getAccessToken() {\n  return localStorage.getItem(ACCESS_TOKEN);\n};\n\nvar request = exports.request = function request(path) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n    method: 'GET'\n  };\n  var originalReturn = arguments[2];\n  var url = '' + BASE_URL + path;\n  var accesstoken = getAccessToken();\n\n  if (options.method === 'GET' && accesstoken) {\n    url += (url.indexOf('?') >= 0 ? '&' : '?') + 'accesstoken=' + accesstoken;\n  }\n\n  return fetch(url, options).then(function (response) {\n    if (!/application\\/json/.test(response.headers.get('Content-Type'))) {\n      throw new Error('系统错误');\n    }\n\n    return response.json();\n  }).then(function (response) {\n    if (originalReturn) {\n      return response;\n    }\n\n    var success = response.success,\n        error_msg = response.error_msg,\n        data = response.data;\n\n    if (!success) {\n      throw new Error(error_msg);\n    }\n\n    return data;\n  });\n};\n\nvar loadTopicList = exports.loadTopicList = function loadTopicList(tab, page, size) {\n  return request('/topics?page=' + page + '&limit=' + size + (tab ? '&tab=' + tab : ''));\n};\n\nvar loadTopicDetail = exports.loadTopicDetail = function loadTopicDetail(id) {\n  return request('/topic/' + id);\n};\n\nvar collectTopic = exports.collectTopic = function collectTopic(id, isCollect) {\n  return request('/topic_collect/' + (isCollect ? 'collect' : 'de_collect'), {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/x-www-form-urlencoded'\n    },\n    body: 'accesstoken=' + getAccessToken() + '&topic_id=' + id\n  }, true).then(function (response) {\n    var success = response.success,\n        error_msg = response.error_msg;\n\n    if (!success && error_msg) {\n      throw new Error(error_msg);\n    }\n\n    return response;\n  });\n};\n\nvar likeReply = exports.likeReply = function likeReply(id) {\n  return request('/reply/' + id + '/ups', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/x-www-form-urlencoded'\n    },\n    body: 'accesstoken=' + getAccessToken()\n  }, true).then(function (response) {\n    var success = response.success,\n        error_msg = response.error_msg,\n        action = response.action;\n\n    if (!success && error_msg) {\n      throw new Error(error_msg);\n    }\n\n    return action;\n  });\n};\n\nvar loadUserDetail = exports.loadUserDetail = function loadUserDetail(id) {\n  return request('/user/' + id);\n};\n\nvar loadUserCollections = exports.loadUserCollections = function loadUserCollections(id) {\n  return request('/topic_collect/' + id);\n};\n\nvar loadMessages = exports.loadMessages = function loadMessages() {\n  return request('/messages');\n};\n\nvar markMessage = exports.markMessage = function markMessage(id) {\n  return request('/message/mark_one/' + id, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/x-www-form-urlencoded'\n    },\n    body: 'accesstoken=' + getAccessToken()\n  });\n};\n\nvar markAllMessage = exports.markAllMessage = function markAllMessage(id) {\n  return request('message/mark_all', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/x-www-form-urlencoded'\n    },\n    body: 'accesstoken=' + getAccessToken()\n  });\n};\n\nvar login = function login(accesstoken) {\n  return request('/accesstoken', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/x-www-form-urlencoded'\n    },\n    body: 'accesstoken=' + accesstoken\n  }, true).then(function (_ref) {\n    var success = _ref.success,\n        error_msg = _ref.error_msg,\n        data = _objectWithoutProperties(_ref, ['success', 'error_msg']);\n\n    if (!success) {\n      throw new Error(error_msg);\n    }\n\n    setAccessToken(accesstoken);\n    return data;\n  });\n};\n\nexports.login = login;\n\nvar logout = exports.logout = function logout() {\n  return setAccessToken('');\n};"],"sourceRoot":""}